<!DOCTYPE html>
<html>
<head>

  <title>10.6 Factoring as Periodicity</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta charset="UTF-8">

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.9.0/katex.min.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.9.0/katex.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.9.0/contrib/auto-render.min.js"></script>

  <link href="../github-markdown.css" rel="stylesheet" type="text/css"/>
  <style>
      .markdown-body {
          box-sizing: border-box;
          min-width: 200px;
          max-width: 980px;
          margin: 0 auto;
          padding: 45px;
      }

      @media (max-width: 767px) {
          .markdown-body {
              padding: 15px;
          }
      }
  </style>
  <link rel="stylesheet" href="../highlight/styles/atom-one-light.css">

  <script src="../highlight/highlight.pack.js"></script>
  <script>hljs.initHighlightingOnLoad();</script>

</head>
<body class="markdown-body">

  <h2 id="factoring-as-periodicity">10.6 Factoring as Periodicity</h2>
  <p>We have seen how the quantum Fourier transform can be used to find the period of a periodic superposition. Now we show, by a sequence of simple reductions, how factoring can be recast as a period-finding problem.</p>
  <p>Fix an integer <span class="math inline">\(N\)</span>. A <em>nontrivial square root of <span class="math inline">\(1\)</span> modulo <span class="math inline">\(N\)</span></em> (recall Exercises 1.36 and 1.40) is any integer <span class="math inline">\(x \not\equiv \pm 1 \bmod{N}\)</span> such that <span class="math inline">\(x^2 \equiv 1 \bmod{N}\)</span>. If we can find a nontrivial square root of <span class="math inline">\(1 \bmod{N}\)</span>, then it is easy to decompose <span class="math inline">\(N\)</span> into a product of two nontrivial factors (and repeating the process would factor <span class="math inline">\(N\)</span>):</p>
  <p> </p>
  <p><strong>Lemma</strong> <em>If <span class="math inline">\(x\)</span> is a non-trivial square root of <span class="math inline">\(1\)</span> modulo <span class="math inline">\(N\)</span>, then <span class="math inline">\(\text{gcd}(x + 1, N)\)</span> is a non-trivial factor of <span class="math inline">\(N\)</span>.</em></p>
  <p><em>Proof.</em> <span class="math inline">\(x^2 \equiv 1 \bmod{N}\)</span> implies that <span class="math inline">\(N\)</span> divides <span class="math inline">\((x^2 - 1) = (x + 1)(x - 1)\)</span>. But <span class="math inline">\(N\)</span> does not divide either of these terms, since <span class="math inline">\(x \not\equiv \pm 1 \bmod{N}\)</span>. Therefore <span class="math inline">\(N\)</span> must have a nontrivial factor in common with each of <span class="math inline">\((x + 1)\)</span> and <span class="math inline">\((x - 1)\)</span>. In particular, <span class="math inline">\(\text{gcd}(N, x + 1)\)</span> is a non-trivial factor of <span class="math inline">\(N\)</span>. <span class="math inline">\(\blacksquare\)</span></p>
  <p><em>Example.</em> Example. Let <span class="math inline">\(N = 15\)</span>. Then <span class="math inline">\(4^2 \equiv 1 \bmod{15}\)</span>, but <span class="math inline">\(4 \not\equiv \pm 1 \bmod{15}\)</span>. Both <span class="math inline">\(\text{gcd}(4 - 1, 15) = 3\)</span> and <span class="math inline">\(\text{gcd}(4 + 1, 15) = 5\)</span> are nontrivial factors of <span class="math inline">\(15\)</span>.</p>
  <p>To complete the connection with periodicity, we need one further concept. Define the <strong>order</strong> of <span class="math inline">\(x\)</span> modulo <span class="math inline">\(N\)</span> to be the smallest positive integer <span class="math inline">\(r\)</span> such that <span class="math inline">\(x^r \equiv 1 \bmod{N}\)</span>. For instance, the order of <span class="math inline">\(2 \bmod{15}\)</span> is <span class="math inline">\(4\)</span>.</p>
  <p>Computing the order of a <em>random number</em> <span class="math inline">\(x \bmod{N}\)</span> is closely related to the problem of finding nontrivial square roots, and thereby to factoring. Here’s the link.</p>
  <p> </p>
  <p><strong>Lemma</strong> <em>Let <span class="math inline">\(N\)</span> be an odd composite, with at least two distinct prime factors, and let <span class="math inline">\(x\)</span> be chosen uniformly at random between <span class="math inline">\(0\)</span> and <span class="math inline">\(N - 1\)</span>. If <span class="math inline">\(\text{gcd}(x, N) = 1\)</span>, then with probability at least <span class="math inline">\(1 / 2\)</span>, the order <span class="math inline">\(r\)</span> of <span class="math inline">\(x \bmod{N}\)</span> is even, and moreover <span class="math inline">\(x^{r / 2}\)</span> is a non-trivial square root of <span class="math inline">\(1 \bmod{N}\)</span>.</em></p>
  <p>The proof of this lemma is left as an exercise. What it implies is that if we could compute the order <span class="math inline">\(r\)</span> of a randomly chosen element <span class="math inline">\(x \bmod{N}\)</span>, then there’s a good chance that this order is even and that <span class="math inline">\(x^{r / 2}\)</span> is a non-trivial square root of <span class="math inline">\(1\)</span> modulo <span class="math inline">\(N\)</span>. In which case <span class="math inline">\(\text{gcd}(x^{r / 2} + 1, N)\)</span> is a factor of <span class="math inline">\(N\)</span>.</p>
  <p><em>Example.</em> If <span class="math inline">\(x = 2\)</span> and <span class="math inline">\(N = 15\)</span>, then the order of <span class="math inline">\(2\)</span> is <span class="math inline">\(4\)</span> since <span class="math inline">\(24 \equiv 1 \bmod{15}\)</span>. Raising 2to half this power, we get a non-trivial root of <span class="math inline">\(1\)</span>: <span class="math inline">\(2^2 \equiv 4 \not\equiv \pm 1 \bmod{15}\)</span>. So we get a divisor of <span class="math inline">\(15\)</span> by computing <span class="math inline">\(\text{gcd}(4 + 1, 15) = 5\)</span>.</p>
  <p> </p>
  <p>Hence we have reduced <span class="math inline">\(\text{FACTORING}\)</span> to the problem of <span class="math inline">\(\text{ORDER FINDING}\)</span>. The advantage of this latter problem is that it has a natural periodic function associated with it: fix <span class="math inline">\(N\)</span> and <span class="math inline">\(x\)</span>, and consider the function <span class="math inline">\(f(a) = x^a \bmod{N}\)</span>. If <span class="math inline">\(r\)</span> is the order of <span class="math inline">\(x\)</span>, then <span class="math inline">\(f(0) = f(r) = f(2r) = \cdots = 1\)</span>, and similarly, <span class="math inline">\(f(1) = f(r + 1) = f(2r + 1) = \cdots = x\)</span>.</p>
  <p>Thus <span class="math inline">\(f\)</span> is periodic, with period <span class="math inline">\(r\)</span>. And we can compute it efficiently by the repeated squaring algorithm from Section 1.2.2. So, in order to factor <span class="math inline">\(N\)</span>, all we need to do is to figure out how to use the function <span class="math inline">\(f\)</span> to set up a periodic superposition with period <span class="math inline">\(r\)</span>; whereupon we can use quantum Fourier sampling as in Section 10.3 to find <span class="math inline">\(r\)</span>. This is described in the next box.</p>
  <p> </p>
  <blockquote>
  <p><strong>Setting Up a Periodic Superposition</strong></p>
  <p>Let us now see how to use our periodic function <span class="math inline">\(f(a) = x^a \bmod{N}\)</span> to set up a periodic superposition. Here is the procedure:</p>
  <ol style="list-style-type: decimal">
  <li><p>We start with two quantum registers, both initially <span class="math inline">\(0\)</span>.</p></li>
  <li><p>Compute the quantum Fourier transform of the first register modulo <span class="math inline">\(M\)</span>, to get a superposition over all numbers <span class="math inline">\(0\)</span> and <span class="math inline">\(M - 1\)</span>: <span class="math display">\[\frac{1}{\sqrt{M}} \sum_{a = 0}^{M-1} \vert a, 0 \rangle.\]</span> This is because the initial superposition can be thought of as periodic with period <span class="math inline">\(M\)</span>, so the transform is periodic with period <span class="math inline">\(1\)</span>.</p></li>
  <li><p>We now compute the function <span class="math inline">\(f(a) = x^a \bmod{N}\)</span>. The quantum circuit for doing this regards the contents of the first register <span class="math inline">\(a\)</span> as the input to <span class="math inline">\(f\)</span>, and the second register (which is initially <span class="math inline">\(0\)</span>) as the answer register. After applying this quantum circuit, the state of the two registers is: <span class="math display">\[\sum_{a = 0}^{M-1} \frac{1}{\sqrt{M}} \vert a, f(a) \rangle.\]</span></p></li>
  <li><p>We now measure the second register. This gives a periodic superposition on the first register, with period r, the period of f.</p></li>
  </ol>
  <p>Here’s why: Since <span class="math inline">\(f\)</span> is a periodic function with period <span class="math inline">\(r\)</span>, for every <span class="math inline">\(r\)</span>th value in the first register, the contents of the second register are the same. The measurement of the second register therefore yields <span class="math inline">\(f(k)\)</span> for some random <span class="math inline">\(k\)</span> between <span class="math inline">\(0\)</span> and <span class="math inline">\(r - 1\)</span>. What is the state of the first register after this measurement? To answer this question, recall the rules of partial measurement outlined earlier in this chapter. The first register is now in a superposition of only those values <span class="math inline">\(a\)</span> that are compatible with the outcome of the measurement on the second register. But these values of <span class="math inline">\(a\)</span> are exactly <span class="math inline">\(k, k + r, k + 2r, \cdots, k + M - r\)</span>. So the resulting state of the first register is a period superposition <span class="math inline">\(\vert \mathbf{\alpha} \rangle\)</span> with period <span class="math inline">\(r\)</span>, which is exactly the order of <span class="math inline">\(x\)</span> tht we wish to find!</p>
  </blockquote>

  <script>
    renderMathInElement(
        document.body,
        {
            delimiters: [
                {left: "$$", right: "$$", display: true},
                {left: "\\[", right: "\\]", display: true},
                {left: "$", right: "$", display: false},
                {left: "\\(", right: "\\)", display: false}
            ]
        }
    );
  </script>
</body>

</html>
